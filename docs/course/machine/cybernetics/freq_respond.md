---
order: 14
---

# 频率响应
除特别声明, 此处的频率默认指角频率, 单位 $rad/s$, 需要除以 $\frac{1}{2\pi}$ 才能得到一般频率

## 频域特性
### 频率信号的稳态响应
对于特定频率的信号 $x_i=A_i\cos(\omega t+\varphi_i)$  
其==稳态响应==必定为 $x_o=A_o\cos(\omega t+\varphi_o)$  
稳态响应的频率与输入信号频率相同, 但幅值与相位改变

### 频率特性求法
定义如下系统的频率特性, 详见书 P122

* 幅值比 $A(\omega)$ 为输入与输出信号的幅值之比, 满足
$$A(\omega)=\frac{A_o}{A_i}=|G(j\omega)|$$  
* 相位差 $\varphi$ 为输入信号与输出信号的相位差, 满足
$$\varphi(\omega)=\varphi_o-\varphi_i=\phase{G(j\omega)}=\operatorname{Arctan}(Re[G(j\omega)],Im[G(j\omega)])$$

### 频率特性的特征量
见书 P143

#### 稳态精度
$\omega=0$ 的幅值比 $A(0)$ 反映了系统的稳态误差  
$A(0)$ 越接近 $1$ (即 $0dB$), 系统的稳态误差越小

#### 复现频率与复现带宽
规定 $\Delta$ 反应低频信号的误差  
当第一次达到 $|A(0)-A(\omega_M)|>\Delta$, 则 $0\sim \omega_M$ 为浮现带宽 

#### 谐振频率与谐振峰值
幅值比达到最大值时的频率为谐振频率 $\omega_r$  
幅值比的最大值与稳态幅值比的比值为谐振峰值 $M_r=\frac{A_{\max}}{A(0)}$  
振荡系统的谐振频率为 $\omega_r=\omega_n\sqrt{1-2\xi^2}$, 仅在 $\xi<0.707$ 时存在

#### 截止频率与截止带宽
当 $A(\omega_b)$ 相比 $A(0)$ 首次下降 $3dB$ ($A(\omega_b)=0.707A(0)$)  
则称 $\omega_b$ 为系统的截至频率, $0\sim\omega_b$ 称为截止带宽

### 最小相位系统
详见书 P145

即相位变化范围最小的系统  
最小相位系统的所有零点与极点都位于左半复平面  
因此其零极点形式传递函数的各个因式中的 $s$ 项系数为正数, 且没有 $e^{-\tau s}$ 的延时环节

## Nyquist 图
### Nyquist 曲线绘制
* 系统传递函数处理
    1. 因式分解系统传递函数的分母
    1. 使用变量代换 $s=j\omega$, 得到 $G(j\omega)$
    1. 分母有理化  
    分子乘上分母各因式的共轭 (注意共轭复数实部相等, 虚部相反), 分母因式变为 $a^2+b^2$ 的形式
    1. 将分子整理为 $a+bj$ 的形式
    1. 拆分为 $A+Bj$, 其中 $A, B$ 为两个多项式分式, 并化简为最简形式 (消去分子与分母中的相同因式)  
    注意, 拆分时检查增益 $K$ 是否被漏掉, 应当乘入式子或保留在式子外
* 按以下顺序确定这五个特殊点的极坐标点与频率 
    1. $\omega\to 0$
    1. $\omega\to +\infty$
    1. $Im[G(j\omega)]=0$
    1. $Re[G(j\omega)]=0$
    1. $A=|G(j\omega)|=1$ (非必须)
    * 求解点时注意
        1. 确定虚部 / 实部时, 不要忘记同时将 $\omega$ 带入分母  
        eg. $Im[G(j\omega)]=\frac{-2.5\omega}{(1+0.25\omega^2)(1+4\omega^2)}$, 当 $\omega=1$ 有 $Im[G(j)]=\frac{-2.5}{(1+0.25)(1+4)}=0.4$
        1. 求 $\omega\to 0,+\infty$ 时, 应使用求极限的方法, 也不要忘记带入分母 (特别是分母有 $\omega^n$ 项)  
        eg. $Re[G(j\omega)]=\frac{-0.6\omega}{\omega(1+0.25\omega^2)(1+0.01\omega^2)}$, 当 $\omega\to 0$ 有 $Re[G(j)]=\frac{-0.6}{(1)(1)}=-0.6$
        1. 复数的幅值即实部与虚部的平方和的开方
        1. 当特殊点为 $(\pm\infty,\pm\infty)$ 时, 还需要根据 $\phase{G(j\omega)}=\operatorname{Arctan}(Re[G(j\omega)], Im[G(j\omega)])$ 确定无穷远点所在的渐近线  
        当特殊点为 $(a, \pm\infty)$, 则渐近线为 $x=a$ 的竖直直线 (实部为 $\infty$ 时同理)
* 绘制 Nyquist 曲线
    1. 将所有特殊点在极坐标图上标出
    1. 根据 $\omega$ 从小到大的顺序以光滑曲线连接特殊点
    1. 使用箭头表明曲线点对应 $\omega$ 的变化方向

## Bode 图
### 典型环节的 Bode 图
具体见书 P142

### 绘制系统 Bode 图
注意, 以下方法仅适用于传递函数中, 所有因式的系数与增益 $K$ 均为正数的情况

#### 幅频曲线渐近线
* 获取系统的零极点增益模型传递函数
    1. 对系统传递函数做因式分解
    1. 将各因式中的常数项提出, 使常数项变为 $1$  
        * 对于 $n$ 次因式, 则提出常数项后还要加上 $n$ 次方
        * 提出常数项后, 因式中的其余项据要除以提出项
    1. 将提出的常数归入增益中  
    提出项位于分子则乘以增益, 位于分母则除以增益
    1. 得到如下所示的零极点增益模型传递函数
$$G(s)=\frac{K\prod(1+T_{zr}s)\prod(1+2T_{zc}\xi_{z} s+T_{zc}^2s^2)}{s^v\prod(1+T_{pr}s)\prod(1+2T_{pc}\xi_{p} s+T_{pc}^2s^2)}$$

* 提取模型的重要参数
    1. 增益 $K$ 与零极点数 $v$
    1. 各个因式中的转角频率 $\omega_T=\frac{1}{T}$

* 确定渐近线线的基本信息
    1. 根据转角频率确定曲线起点 $\omega_0$, 满足 $\omega_0<\min(\omega_{Ti})$ 的前提下可任意取值
    1. 曲线起始点满足 $P_0=(\omega_0, 20\lg K-20v\lg\omega_0)$
    1. 曲线的起始斜率满足 $c_0=-20v (dB/dec)$
    1. 按从小到大排列转角频率
    1. 根据转角频率对应的环节, 确定转角频率 $\omega_{Ti}$ ==之后==的斜率 $c_i=c_{i-1}+m_i (dB/dec)$  
        * 所在因式中的 $s$ 的次数为 $n$, 则 $m_i=\pm n\cdot 20(dB/dec)$ (区分惯性与振荡环节, 因式的次数也要考虑)
        * 位于分母则 $m_i$ 取负 (惯性或振动环节), 位于分子 $m_i$ 取正 (一阶或二阶积分环节)

* 绘制渐近线
    1. 按 $3, 3, 2, 1, 1$ 的子刻度对应 $2, 4, 6, 8, 10$ 划分对数频率轴, 分贝频率轴则按一般方法绘制
    1. 确定渐近线的各个转折点 $P_i=(\omega_{Ti},g_i)$   
    转折点对应的值满足 $g_i=g_{i-1}+c_i\times \lg(\omega_{Ti}-\omega_{Ti-1})$
    1. 连接所有转折点, 并在首位两端根据斜率延伸 (末端射线需要具体计算, 前端射线连接 $P_0P_1$ 即可)  
    1. 在图上标出各段渐近线的斜率, 单位 $dB/dec$

#### 相频曲线绘制
* 确定相频曲线的基本信息
    1. 曲线的起始相位满足 $\varphi_{0}=-v\cdot 90\degree$
    1. 根据转角频率对应的环节, 确定转角频率 $\omega_{Ti}$ 之后的==渐进相位== $\varphi_{i}=\varphi_{i-1}+\psi(\degree)$
        * 所在因式中的 $s$ 的次数为 $n$, 则 $\psi_i=\pm n\cdot 90\degree$ (区分惯性与振荡环节, 因式的次数也要考虑)
        * 位于分母则 $\psi_i$ 取负 (惯性或振动环节), 位于分子 $\psi_i$ 取正 (一阶或二阶积分环节)
    1. 确定理论拐点坐标 $Q_i=(\omega_{Ti},\varphi_{Mi})$
    理论拐点坐标值满足 $\varphi_{Mi}=(\varphi_{i}-\varphi_{i-1}) / 2$

* 绘制相频曲线
    1. 坐标轴绘制方法同[幅频曲线](#幅频曲线渐近线)
    1. 在坐标图上标出所有渐进相位, 并绘制水平虚线辅助线
    1. 在坐标图上标出所有理论拐点
    1. 根据相隔最近的拐点, 在理论拐点基础上略微竖直浮动得到实际拐点 (向最近拐点方向移动)  
    1. 根据拐点与辅助线, 画出一条光滑曲线 (除最后一条渐近线, 其他曲线均与渐近线相隔一段距离)

### 基于幅频曲线的参数估计
来自书 P287
