---
order: 15
---

# 稳定性
## 稳定性基本条件
### 特征方程与稳态响应
系统传递函数的分母代表了系统的特征方程, 假设特征方程的根为 $\lambda_i=a_{i}+b_{i}j$    
则系统有自由稳态响应 (与输入无关的稳态响应) $x_o=\sum_{i=1}^{n}A_ie^{\lambda_{i}t}$  

因此仅当所有特征根的实部 $a_{i}<0$ 才能保证 $x_o$ 快速衰减, 仅留下与输入有关的强迫相应  
此外认为 $\lambda_i=0$ 时, 系统的稳态响应为常数, 也属于稳定

综上所述, 系统稳定的条件为特征根 $\lambda_i=0$ 或特征根的实部 $a_i<0$  
但出现不满足以上条件的特征根, 则系统临界稳定或不稳定

详细见书 P155
### 系统稳定的必要条件
习惯上处理特征方程时, 通常会对其乘以 $-1$ 以保证尽量多的系数为正数 (以下默认处理)  

易得系统稳定的必要条件为 (证明见书 P157)
* 特征方程各项系数 $a_i$ 都不等于零
* 特征方程各项系数 $a_i$ 的符号相同 (按习惯处理后, 各项系数均为正数)

### Routh 判据
Routh 判据为通过特征方程 (系统传递函数分母) 的系数 $a_i$ 来判断是否满足稳定的方法

根据 Routh 判据  
对于二阶系统要求方程系数 $a_2,a_1,a_0>0$   
对于三阶系统要求方程系数 $a_3,a_2,a_1,a_0>0,a_1a_2-a_0a_3>0$  

对于高阶特征方程, 需要使用 Routh 判据具体计算  
关于 Routh 判据的使用见 P157, 系统稳定性要求 Routh 表第一列各元素符号不变 (当有元素为 $0$ 时系统必定临界稳定或不稳定)  
关于 Routh 判据的例外处理见 P161

## Nyquist 判据
### Cauchy 原理
假设 $F(s)$ 为复数域的分式多项式 
$$F(s)=\frac{K\prod(s-z_i)}{\prod(s-p_i)}$$  
对于复平面 $[s]$ 上的一条闭合曲线 $L_s$, 该平面经过复变函数 $F(s)$ 的映射 $[F(s)]$ 上则有由 $s$ 上的点映射得到的闭合曲线 $L_F$    

由于 $F(s)$ 的辐角 (函数值 $F(s)$ 相对原点的夹角) 满足 
$$\phase{F(s)}=\sum\phase{(s-z_i)}-\sum\phase{(s-p_i)}$$
假设点 $s_k$ 被 $L_s$ 包围, 当 $s$ 绕 $L_s$ 顺时针旋转一圈, 对于 $s_i\neq s_k$, $\phase{(s-z_i)}$ 经过旋转后回到原始值, $\phase{(s-z_k)}$ 则相比原始值变化了了 $-2\pi$ (顺时针旋转), 在曲线 $L_F$ 上则体现为绕原点旋转顺时针旋转一圈

推广可得, 当 $L_s$ 顺时针旋转一圈, $L_F$ 将==绕原点顺时针旋转 $N=Z-P$ 圈== ($Z,P$ 为分式多项式 $F(s)$ 的零点, 极点数)

### Nyquist 判据
根据传递函数的反馈公式可得, 系统的传递函数满足 $G_b(s)=\frac{G}{1+GH}$  
观察可得, 对于系统的开环传递函数 $G_k(s)=GH$, $G_b(s)$ 的极点即 $F(s)=1+G_k(s)$ 的零点  

令 $L_s$ 为一条以 $[s]$ 虚轴为直径, 圆弧在右半平面上的半圆 (当经过 $F(s)$ 极点时, 使用半径无穷小的圆弧绕过)  
当 $L_s$ 顺时针旋转后, 其映射 $L_F$ 将绕原点旋转 $N=Z-P$ 圈, $Z,P$ 为 $F(s)$ 在右半平面 ($Re\ge 0$) 的零点数与极点数  
当 $G_b(s)$ 为[最小相位系统](./freq_respond.md#最小相位系统), $P=0$, 因此旋转圈数即 $F(s)$ 的在右半平面零点数, 也是传递函数 $G_b(s)$ 在右半平面的极点数

由于系统存在惯性, 分子分母次数 $m,n$ 满足 $n\ge m$, 因此 $L_s$ 的 $R=\infty$ 圆弧映射为一个点
顺时针旋转时, $L_s$ 半圆的直径则是一条竖直向上的直线, $F_s$ 即 $F(j\omega)$ 在 $\omega=-\infty\to\infty$ 的曲线  
易得 $\omega=-\infty\to 0$ 与 $\omega=0\to\infty$ 的曲线相对实轴对称

通常以开环传递函数 $G_k(s)$ 为分析对象, 此时映射曲线 $L_G$ 即开环传递函数的 Nyquist 图  
而 $[F(s)]$ 中的原点映射到 $[G_k(s)]$ 中为 $(-1, 0)$ 点  
因此系统特征方程中位于右半平面的极点个数即其开环传递函数 $G_k(s)$ 在 $\omega=-\infty\to\infty$ 的 Nyquist 曲线绕 $(-1,0)$ 点旋转圈数  

当==系统稳定==时, 其==开环传递函数在 $\omega=-\infty\to\infty$ 的 Nyquist 曲线绕 $(-1,0)$ 顺时针旋转 $-P$ 圈== (对于最小相位系统 $P=0$)

### 使用 Nyquist 判据注意
* 应使用相位变化的方式理解旋转圈数, 即当曲线顺时针绕 $(-1,0)$ 旋转一圈后, 又绕此点逆时针旋转一圈, 则总旋转圈数为 $0$
* 按[Nyquis 图绘制方法](./freq_respond.md#nyquist-曲线绘制)绘制 $0\to\infty$ 的曲线后, 关于实轴对称即可得到 $\omega=-\infty\to\infty$ 的 Nyquist 曲线
* 当绕 $(-1,0)$ 逆时针旋转, 表明系统稳定, 但不是最小相位系统 (开环不稳定)  
当题目表明系统开环稳定时, 说明 $P=0$
* 当 $\omega=0^+$ 时的点位于无穷远处 (一般此时的 $G_k(s)$ 分母有因式 $s^v$), 此时 $\omega=0^-\to 0^+$ 点的连线之间有一条半径 $\infty$, 弧度为 $v\pi$ ($0^-$ 到 $0^+$ 顺时针旋转) 的圆弧 (虚线标出)

### Bode 判据
根据 Nyquist 曲线与 Bode 图幅频 / 相频曲线之间的联系, 推广可得到 Bode 判据  

定义, 对于==开环传递函数的 Bode 图==
* 对数幅频曲线与横轴 ($0dB$ 水平线, 对应 Nyquist 图的单位圆) 的交点对应的频率称为剪切频率 $\omega_c$ (多个交点取最大值)  
即 Nyquist 曲线与单位圆交点对应的频率
* 对数相频曲线与 $-180\degree$ 水平线 (对应 Nyquist 图的负实轴) 的交点对应的频率称为相位交界频率 $\omega_g$ (多个交点取最小值)  
即 Nyquit 曲线与负实轴交点对应的频率

对于最小相位系统稳定时有 $\omega_c<\omega_g$  
对于非最小相位系统, 可使用接下来介绍的穿越法

### 基于正负穿越概念的 Nyquist 判据
使用穿越的方式描述 Nyquist 曲线绕 $(-1,0)$ 点的旋转

#### 正负穿越判断
沿 $\omega$ 增大的方向, 将以下情况记为一次穿越
* 在 $\omega=0\sim\infty$ 的开环 Nyquist 曲线上穿过 ==$(-1,0)$ 点左侧的实轴==
    * 穿越方向为自==上而下==时, 记为正穿越
    * 穿越方向为自==下而上==时, 记为负穿越
    * 来自 ==$(-\infty,0)$ 的渐近线向下移动==时 (通常为 $\omega=0^+$ 的对应点), 记为==正半次穿越==, 反之则为负半次穿越
* 在开环 Bode 图的==对数相频曲线==上穿过直线 $\varphi=-180\degree$, 且==交点对应的幅值大于 $0dB$==
    * 穿越方向为自==下而上==时, 记为正穿越
    * 穿越方向为自==上而下==时, 记为负穿越
    * 来自 ==$\varphi=-180\degree$ 的渐近线向上移动==时 (通常为 $\omega=0^+$ 的对应点), 记为==正半次穿越==, 反之则为负半次穿越

#### 正负穿越的使用
* 正穿越次数减去负穿越次数==再乘以 $2$== 即开环 $Nyqist$ 曲线绕 $(-1,0)$ 点==逆时针旋转==次数, 可以此判断系统是否稳定
* 对于开环 Nyquist 曲线, 通过增加增益 $K$, 可使曲线与实轴的交点坐标乘以 $K$, 使交点移动以改变穿越次数, 从而改变系统的稳定性
* 对于 Bode 图, 通过增加增益 $K$, 可使对数幅值曲线向上平移 $20\lg K$, 使对数相频曲线的穿越点生效 / 失效, 从而改变系统的稳定性

### 相位裕度
定义相位裕度 $\gamma$ 为
* Nyquist 图上, $\omega_c$ 对应点相对负实轴的夹角 (负实轴逆时针到对应点角度为正)
* Bode 图上, ==$\omega_c$ 对应的相位角加上 $180\degree$==, 即 $\gamma=180\degree+\phase{G_k(\omega_c j)}$

系统稳定时, 相位裕度为正值 $\gamma>0$, 一般要求 $\gamma=30\degree\sim 60\degree$

### 幅值裕度
定义幅值裕度 $K_g$ 为
* Nyquist 图上, $\omega_g$ 对应点相对原点距离绝对值的导数, 此时的到的幅值裕度单位为 $1$
* Bode 图上, $\omega_g$ 对应==幅值的相反数==, 此时的到的幅值裕度单位为 $dB$

当 $K_g=1$ 正好在 $(-1,0)$ 上, 因此系统稳定时, 幅值裕度 $K_g>1$, 一般要求 $K_g>2$  
通常会对幅值裕度取分贝, 此时, 系统稳定时, 幅值裕度 $K_g(dB)>0dB$, 一般要求 $K_g(dB)>6dB$

### 计算注意
* 计算幅值裕度 / 相位裕度时, 可先求出开环传递函数的频率特性 $G_k(\omega j)$, 然后使用计算器等直接求解方程  
$|G_k(\omega_c j)|=1,Im[G_k(\omega_g j)]=0$ 求出 $\omega_c$ 与 $\omega_g$
* 将计算得到的 $\omega_c$ 与 $\omega_g$ 带入开环传递函数, 求出相位裕度与幅值裕度  
满足 $\gamma=\phase{G_k(\omega_c j)}+180\degree,K_g=\frac{1}{|G_k(\omega_k j)|},K_g(dB)=-20\log_{10}(|G_k(\omega_k j)|)$
* 计算 $\gamma$ 时应使用四象限反正切函数 $\operatorname{Arctan}$ (或利用计算器的 <kbd>POL</kbd> 函数, 确定点 $G_k(\omega_c j)$ 的夹角, 注意确定并带入坐标点的正负符号)  
当得到的 $\gamma$ 在 $[-180\degree,180\degree]$ 范围外时, 可画出向量 $G_k(\omega_c j)$, 具体分析该向量与负实轴的夹角 (负实轴逆时针到对应点角度为正)
