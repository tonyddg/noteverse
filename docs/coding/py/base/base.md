---
order: 1
---

# 基本语法
## 格式
### 脚本说明

#### 解释器
```python
#!/usr/bin/python
#!/usr/bin/env python
```
编写 python 脚本时, 需要在第一行说明采用的解释器
1. 写法1 表示采用默认的解释器
2. 写法2 表示在环境变量中查找使用的解释器, 推荐

#### 脚本编码
```python
# -*- coding: UTF-8 -*-
```
编写 python 脚本时, 需要在第二行有此语句表明编码

### 标识符
1. 单下划线开头 _foo 的代表不能直接访问的类属性, 不能用 from xxx import * 而导入
2. 以双下划线开头的 __foo 代表类的私有成员
3. 以双下划线开头和结尾的 __foo__ 代表 Python 里特殊方法专用的标识

### 行和缩进
python 最具特色的就是用缩进来写模块, 缩进可以是 单个制表符 或 两个空格 或 四个空格, 但需要统一

### 多行语句
1. 可以使用斜杠 (\\) 将一行的语句分为多行显示
2. 语句中包含 [], {} 或 () 括号就不需要使用多行连接符

### 引号
1. Python 可以使用引号( ' ), 双引号( " ), 三引号( ''' 或 """ ) 表示字符串
2. 三引号可以由多行组成, 编写多行文本的快捷语法

### 注释
1. python中单行注释采用 # 开头
2. python 中多行注释使用三个单引号 ''' 或三个双引号 """
eg.
```python
'''
这是多行注释，使用单引号。
这是多行注释，使用单引号。
'''

"""
这是多行注释，使用双引号。
这是多行注释，使用双引号。
"""
```

### 同一行显示多条语句
Python可以在同一行中使用多条语句，语句之间使用分号(;)分割

## 变量
### 标准数据类型
* Numbers (数字)
    * int (有符号整型)
    * float (浮点型)
    * complex (复数) 使用 1j 表示虚数单位
    * bool (布尔)
* String (字符串)
* List (列表)
* Tuple (元组)
* Dictionary (字典)
* Set (集合)
* None (无类型)

#### 删除变量
del [变量]
删除指定变量

#### 类型转换
与 C 类似, 具体查表

## 运算符
仅列出与 C 的不同

|操作符|功能|
|--|--|--|
|**|幂运算|
|//|整除(向下取整)|
|~|按位取反|
|and|逻辑与|
|or|逻辑或|
|not|逻辑非 (注意在 if 中应使用逻辑运算)|
|is|判断变量地址是否相同|
|in|判断元素是否在列表/字符串中|

### 运算符说明
* 存在运算赋值 (+= 等)
* 不存在自增/自减运算符
* 逻辑运算使用 and, or, not, 同样有短路求值
* 位运算不变

## 流程控制
* 没有 switch/case 语句

### 条件语句
```python
if 判断条件1:
    执行语句1……
elif 判断条件2:
    执行语句2……
elif 判断条件3:
    执行语句3……
else:
    执行语句4……
```
注意条件后的冒号 :

### while 循环
```python
while 判断条件：
    执行语句……
```

### for 循环
```python
for ([迭代索引],) [迭代变量] in 迭代体:
   执行语句
```
可通过 range() 生成线性迭代体

### 循环控制
1. break 打破一层循环
2. continue 进入下一轮循环
3. pass 不进行任何操作

## 复杂类型
### 字符串
#### 字符串索引
1. 从左往右索引时, 索引值由 0 开始
2. 从右往左索引时, 索引值由 -1 开始

#### 截取字符串
1. 使用语法 [头下标(包含):尾下标(不包含)], 可用于截取子字符串
2. 省略下标则表示从最左端/右端选择

#### 字符串运算符
|操作符|功能|示例|
|--|--|--|
|+|连接字符串|
|*|重复输出字符串|
|in|判断元素是否在字符串中|"Hello" in "ell" = true|
|not in|判断元素是否不在字符串中|

#### 转义与格式化
1. 格式化转义符与 C 相同
1. 格式化语法 
    * `"格式化字符串"%(格式化参数)`
    * 使用成员函数 `format`

格式化示例, 参考自  
<http://www.cppcns.com/jiaoben/python/287553.html>   
<https://zhuanlan.zhihu.com/p/295621558>

* 参数填充
    * `{}` 按输入参数顺序填充
    * `{n}` 填充第 n 个参数, 从 0 开始计算
    * `{val}` 填充入名称为 val 的参数
    * 示例
```python
# 基本替换
"y = {}x + {}".format("a", 12)
# 输出 "y = ax + 12"

# 按参数位置替换
"y = {0}x^2 +{1}x + {0}".format("a", 12)
# 输出 "y = ax^2 +12x + a"

# 按参数名称替换
"y = {num}x^2 +{param}x + {num}".format(num = 12, param = "a")
# 输出 "y = 12x^2 +ax + 12"
```

* 字符串填充规则  
占用 n 个字符的宽度, 空白位置使用 `x` 填充 (未指定则使用空格)
    * `{:x<n}` 左对齐
    * `{:x>n}` 右对齐
    * `{:x^n}` 居中对齐
    * 示例
```python
# 宽度控制
# 左对齐
print("out:{str:<10}\n    0123456789".format(str = "Hello"))
# 输出
# out:Hello     
#     0123456789

# 右对齐
print("out:{str:>10}\n    0123456789".format(str = "Hello"))
# 输出
# out:     Hello
#     0123456789

# 居中对齐
print("out:{str:^10}\n    0123456789".format(str = "Hello"))
# 输出
# out:  Hello   
#     0123456789
```

* 数字格式化
    * `{:.nf}` 保留 n 位小数
    * `{:.n%}` 百分数, n 为百分数后的小数位
    * `{:.ne}` 科学计数法, n 为小数部分的小数位
    * `{:+}` 带符号 (前缀)
    * `{:,}` 千位分隔符 (前缀)
    * `{x>/</^n}` 对齐, 含义见上 (前缀)
    * `{:#X}` 十六进制 (仅用于整数)
```python
# 保留 n 位小数
print("{pi:.3f}".format(pi = 3.14159))
# 输出 3.142

# 百分数
print("{pi:.2%}".format(pi = 3.14159))
# 输出 314.16%

# 科学计数法
print("{pi:.3e}".format(pi = 314159))
# 输出 3.142e+05

# 带符号保留
print("{pi:+.3f}".format(pi = 3.14159))
# 输出 +3.142

# 千位分隔符
print("{num:,}".format(num = 3141.5926))
# 输出 3,141.5926

# 对齐
print("out: {pi:0^10.2f}".format(pi = 3.14159))
# 输出 out: 0003.14000

# 十六进制
print("{pi:#X}".format(pi = 314159))
# 输出 0X4CB2F
```

* `{}` 转义  
使用 `{{}}` 可对 `{}` 进行转义, 保留并输出 `{}`  
示例

```python
"\\frac{{{y}}}{{x}}".format(y = 10)
> '\\frac{10}{x}'
```

* `f-string`

#### 字符串标记
放在字符串最前处, eg R"Hello"
1. `r/R` 原始字符串, 不转义
2. `u` unicode 字符串

### 列表
即数组, 但可以包含不同类型的元素

#### 添加元素
`list.append([元素])`  
向列表后方添加元素

#### 删除元素
`del list[n]`
删除第 n 个元素

#### 索引
同字符串, 也可使用索引截取子列表

#### 深拷贝
列表的赋值与传递为浅拷贝, 可通过赋值子列表的方式深拷贝
```python
copy_list = original_list[:]
```

### 元组
1. 与列表相同, 但元组不能修改与删除, 可以复制与连接
2. 使用 `()` 创建与表示

### 字典
#### 创建字典
```python
var1 = {[键1]:[值1], [键2]:[值2], ...}
```
* 键与值可以是任意类型, 但键的值不能改变

#### 修改字典
1. 使用 `[键]` 索引字典
2. 当使用一个不存在的键时, 将自动创建
3. 使用 `del dict[key]` 删除键值对

### 集合
无序不重复的元素序列

#### 创建集合
```python
set1 = set([元素1], [元素2], ...)
```

#### 添加元素
1. `set.add(x)`
添加元素, 如果元素已存在则不操作
2. `set.update(x)`
添加列表, 元组内的元素

#### 删除元素
1. `set.discard(x)`
删除元素, 如果元素不存在不会出错
2. `set.remove(x)`
删除元素, 如果元素不存在会出错

#### 元素是否在集合中
`x in set`
判断 x 是否在集合中

### 通用操作
#### 获取长度
* 可使用内置函数 `len(<复杂类型>)` 来获取长度
* 使用特殊成员函数 `val.__len__()` 也可以获取变量的长度

## 函数
```python
def 函数名(函数参数):
   '''
   函数_文档字符串"
   '''
   函数体
   return [返回值]
```

1. return [表达式] 结束函数
2. 不带表达式的return相当于返回 None
3. 函数的第一行语句可以选择性地使用文档字符串—用于存放函数说明
4. 函数文档字符串用三引号可实现多行, 并且可以在注释中使用 Markdown 语法

### 参数传递
#### 可变类型
类似 C++ 的引用传递  
列表, 字典使用此方式传递参数  
* 赋值中, 此两种类型为浅拷贝  

#### 不可变类型
类似 C++ 的值传递  
整数, 字符串, 元组使用此方式传递参数  
赋值中, 此类类型为深拷贝  

### 参数类型
#### 关键字传参
可以指定参变量的方式传参  
eg. `fun(a = 10, b = 20)`

#### 默认参数
可以在函数参数中指定默认参数

#### 不定长参数
加了星号 (*) 的变量名会存放所有未命名的变量参数  
eg. `def fun(a, b, *args)  `  
其中 `args` 为元组  

当需要将一个保存了一系列参数值的元组传入函数时, 可以使用 `*[参数元组]`  
```python
arglist = (..., ...)

fun(..., ..., *arglist)
```

#### 不定长带名称参数
加了双星号 (**) 的变量名将会存放所有由命名但没有定义的变量参数    
eg. `def save(file, *args, **kwargs)`  
其中, `kwargs` 将作为一个参数字典变量, 调用 `save(xxx = val)` 时, 产生键值对 `kwargs['xxx'] = val`   

当需要将一个保存了一系列参数名称与参数值的字典传入函数时, 可以使用 `**[参数字典]`  
```python
paras = {
    "...": ..., ...
}

fun(..., ..., **paras)
```

### 匿名函数
```python
lambda [参数1], [参数2], ... : 函数体
```
lambda函数拥有自己的命名空间, 且不能访问自有参数列表之外或全局命名空间里的参数

### 作用域
1. 函数内的局部变量无法被外部访问
2. 函数要访问外部的全局变量, 需要使用 global [全局变量] 声明

### 传递函数
1. 函数可以作为参数传递
2. 函数可在函数体内定义, 然后作为返回值返回
eg. 
```python
def funx(x):
    def funy(y):
        return x * y
    return funy

funx(7)(8)
```

### 返回值
函数可以返回多个值, 使用 return a1, a2, ... 表示
返回值将以元组的形式返回, 或者可用多个变量接收返回值
eg.
```python
def fun() :
    return 1, 2, 3

a, b, c = fun()
print(a, b, c)
```
将输出 1 2 3

## 推导式
通过字符串, 从一个数据序列构建另一个序列, 可以被 `input` 函数解析或直接使用表示变量的值

### 列表推导式
```python
res = [out_exp_res for out_exp in input_list if condition]
```
1. res 结果列表
2. out_exp_res 遍历列表元素的表达式, 返回值作为列表元素
3. out_exp 表达式中的迭代变量
4. input_list 输入列表(可迭代类型)
5. condition 迭代变量满足条件

* eg. 过滤掉长度小于或等于 3 的字符串列表, 并将剩下的转换成大写字母
```python
* new_names = [it.upper() for it in names if len(it) > 3]
```

* 注意, 输入列表也可以是返回列表的函数, 如 range()

### 字典推导式
```python
res = { key_expr: value_expr for value in collection if condition }
```
1. res 结果字典
2. key_expr 遍历列表元素的表达式, 返回值作为键名
3. value_expr 遍历列表元素的表达式, 返回值作为键值
4. value 表达式中的迭代变量
5. collection 输入列表(可迭代类型)
6. condition 迭代变量满足条件

* eg. 使用字符串及其长度创建字典
```python
newdict = {key:len(key) for key in listdemo}
```

### 集合推导式
```python
res = { expression for item in Sequence if conditional }
```
与列表相同, 使用 {} 包裹

### 元组推导式
```python
res = (expression for item in Sequence if conditional )
```
与列表相同, 使用 () 包裹
注意元组推导式返回的是生成器对象, 不是元组
生成器对象不直接保存数据, 而是在迭代时计算结果
需要使用以下方法生成元组
```python
res = tuple([生成器])
```

### 分支推导式
```python
res = [结果1 if 判断条件 else 结果2 for 变量名 in 原列表]
```

## 模块
### 模块导入
```python
import [模块1], [模块2], ...
```
调用此法导入的模块时, 需要使用 [模块名].[模块方法] 的方式使用

### 全局导入
```python
from [模块] import [模块方法/*]
```
导入模块方法, 使用 * 则是导入全部方法, 用此法导入的方法将作为全局方法

### 别名导入
```python
import [模块] as [别名] 
```
可以对导入的模块起别名

### 模块相关函数
1. dir([模块])
查找模块中所有的函数, 变量
2. globals()
查找所有全局变量
3. locals()
查找所有局部变量

### 包
1. 一个包中可以包含多个模块
2. 包为一个文件夹, 里面有多个子模块(.py)
3. 包中必须有文件 \_\_init\_\_.py, 用于在启动包时调用

### \_\_name\_\_ 属性
模块第一次被另一个程序引用时, 将运行模块内的程序, 通过 \_\_name\_\_ 属性, 判断模块是被引用还是作为独立的程序运行
```python
if __name__ == '__main__':
   [程序自身在运行]
else:
   [作为模块运行]
```
每个模块都有一个 \_\_name\_\_ 属性, 当其值是 '\_\_main\_\_' 时, 表明该模块自身在运行, 否则是被引入

### dir() 函数
dir([模块导入名])
可以找到模块内定义的所有名称, 以一个字符串列表的形式返回

### 常用模块
|模块名|功能|
|--|--|
|math|数学库|
|cmath|复数运算|
|time|时间库|
|calendar|日历库|
|sys|系统信息|
|os|管理系统/文件|
|re|正则表达式|
|json|json 解析|

