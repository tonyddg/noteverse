import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{o as n,c as e,e as l,b as s,d as a}from"./app-8c5ce49e.js";const i={},m=l('<h1 id="电压采集-adc" tabindex="-1"><a class="header-anchor" href="#电压采集-adc" aria-hidden="true">#</a> 电压采集 ADC</h1><h2 id="外设介绍" tabindex="-1"><a class="header-anchor" href="#外设介绍" aria-hidden="true">#</a> 外设介绍</h2><h3 id="adc-基本功能" tabindex="-1"><a class="header-anchor" href="#adc-基本功能" aria-hidden="true">#</a> ADC 基本功能</h3><h4 id="电压采集" tabindex="-1"><a class="header-anchor" href="#电压采集" aria-hidden="true">#</a> 电压采集</h4>',4),r=s("p",null,[a("ADC 电压采集范围为 $$V_{Ref-}\\le V_{In}\\le V_{Ref+}$$ 通常 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"V"),s("mrow",null,[s("mi",null,"R"),s("mi",null,"e"),s("mi",null,"f"),s("mo",null,"−")])])]),s("annotation",{encoding:"application/x-tex"},"V_{Ref-}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.2222em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mord mathnormal mtight"},"e"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.10764em"}},"f"),s("span",{class:"mord mtight"},"−")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])])])])]),a(" 接地, "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"V"),s("mrow",null,[s("mi",null,"R"),s("mi",null,"e"),s("mi",null,"f"),s("mo",null,"+")])])]),s("annotation",{encoding:"application/x-tex"},"V_{Ref+}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.9694em","vertical-align":"-0.2861em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.2222em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.00773em"}},"R"),s("span",{class:"mord mathnormal mtight"},"e"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.10764em"}},"f"),s("span",{class:"mord mtight"},"+")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2861em"}},[s("span")])])])])])])])]),a(" 接 3.3V, 因此范围为 $$0V\\sim 3.3V$$")],-1),h=s("h4",{id:"输入通道",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#输入通道","aria-hidden":"true"},"#"),a(" 输入通道")],-1),c=s("p",null,[a("一个 ADC 外设有多个通道, 每个通道对应不同的 IO 口, 还有内部通道链接内部的 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"V"),s("mrow",null,[s("mi",null,"S"),s("mi",null,"S")])])]),s("annotation",{encoding:"application/x-tex"},"V_{SS}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"V"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3283em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.2222em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.05764em"}},"SS")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),a(" 与 温度传感器, 具体查表")],-1),p=l('<h4 id="规则通道转换顺序" tabindex="-1"><a class="header-anchor" href="#规则通道转换顺序" aria-hidden="true">#</a> 规则通道转换顺序</h4><p>转换顺序由寄存器 SQR1,2,3 的位 SQn 决定, 寄存器中存放第 n 个转换的通道, SQR3 中的 SQL 还存放要转换的通道数</p><h4 id="注入通道转换顺序" tabindex="-1"><a class="header-anchor" href="#注入通道转换顺序" aria-hidden="true">#</a> 注入通道转换顺序</h4><p>注入通道能在规则通道转换时插队, 由寄存器 JSQR 决定, 顺序与 SQn 相反, JSQ4 存放的通道编号最先转换</p><h4 id="触发源" tabindex="-1"><a class="header-anchor" href="#触发源" aria-hidden="true">#</a> 触发源</h4><ol><li>ADC_CR2 中 ADON 位可控制转换的开始与结束</li><li>还可具体设置触发源, 注入通道与规则通道分别设置</li></ol><h4 id="转换时间" tabindex="-1"><a class="header-anchor" href="#转换时间" aria-hidden="true">#</a> 转换时间</h4>',7),o=s("ol",null,[s("li",null,"ADC 时钟由 PCLK2=72MHz 经分频产生, 最大为 14MHz, 但分频最大只能为 12MHz"),s("li",null,"通道 0~9 与 10~17 的采样周期分别由 ADC_SMPR2,1 控制, 最快为 1.5 个周期 T"),s("li",null,[a("转换时间 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"v")])]),s("mo",null,"="),s("mtext",null,"采样时间"),s("mo",null,"+"),s("mn",null,"12.5"),s("mi",null,"T")]),s("annotation",{encoding:"application/x-tex"},"T_{conv}=\\text{采样时间}+12.5T")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.1514em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"co"),s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"v")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7667em","vertical-align":"-0.0833em"}}),s("span",{class:"mord text"},[s("span",{class:"mord cjk_fallback"},"采样时间")]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"12.5"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T")])])]),a(", 因此最快情况下 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"T"),s("mrow",null,[s("mi",null,"c"),s("mi",null,"o"),s("mi",null,"n"),s("mi",null,"v")])]),s("mo",null,"="),s("mn",null,"14"),s("mi",null,"T"),s("mo",null,"="),s("mn",null,"14"),s("mi",{mathvariant:"normal"},"/"),s("mn",null,"14"),s("mi",null,"M"),s("mi",null,"H"),s("mi",null,"z"),s("mo",null,"="),s("mn",null,"1"),s("mi",null,"μ"),s("mi",null,"s")]),s("annotation",{encoding:"application/x-tex"},"T_{conv}=14T=14/14MHz=1\\mu s")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8333em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.1514em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.1389em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mathnormal mtight"},"co"),s("span",{class:"mord mathnormal mtight"},"n"),s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.03588em"}},"v")])])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord"},"14"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},"14/14"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"M"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.04398em"}},"Hz"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8389em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},"1"),s("span",{class:"mord mathnormal"},"μ"),s("span",{class:"mord mathnormal"},"s")])])])]),s("li",null,[a("由于分频限制, 实际最快周期为 12MHz, 因此实际最快采样时间为 "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mn",null,"1.17"),s("mi",null,"μ"),s("mi",null,"s")]),s("annotation",{encoding:"application/x-tex"},"1.17\\mu s")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8389em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},"1.17"),s("span",{class:"mord mathnormal"},"μ"),s("span",{class:"mord mathnormal"},"s")])])])])],-1),d=l('<h4 id="数据存储" tabindex="-1"><a class="header-anchor" href="#数据存储" aria-hidden="true">#</a> 数据存储</h4><ol><li>仅有一个 32 位的数据寄存器 ADC_DR 存放规则通道的采样结果, 当有多个通道将覆盖</li><li>低 16 位存放 ADC1,2,3 其中一个的结果, 高 16 位在开启 ADC1 双通道模式下, 存放 ADC2 结果</li><li>为了防止覆盖, 通常将采用 DMA 保存结果</li><li>注入通道有 4 个寄存器存放结果, 不会覆盖</li></ol><h4 id="中断" tabindex="-1"><a class="header-anchor" href="#中断" aria-hidden="true">#</a> 中断</h4><ol><li>转换结束中断</li><li>模拟看门狗中断 当电压低于/高于阈值时触发中断</li><li>DMA 请求 仅 ADC1,3 可使用 DMA</li></ol><h4 id="电压转换" tabindex="-1"><a class="header-anchor" href="#电压转换" aria-hidden="true">#</a> 电压转换</h4><p>ADC 精度为 12 位, 在默认 3.3V 情况下, 计算公式有</p>',6),g=s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Y"),s("mo",null,"="),s("mn",null,"3.3"),s("mo",null,"×"),s("mi",null,"X"),s("mi",{mathvariant:"normal"},"/"),s("msup",null,[s("mn",null,"2"),s("mn",null,"12")])]),s("annotation",{encoding:"application/x-tex"}," Y=3.3\\times X/2^{12} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.22222em"}},"Y"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.7278em","vertical-align":"-0.0833em"}}),s("span",{class:"mord"},"3.3"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"×"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.1141em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07847em"}},"X"),s("span",{class:"mord"},"/"),s("span",{class:"mord"},[s("span",{class:"mord"},"2"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.8641em"}},[s("span",{style:{top:"-3.113em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},[s("span",{class:"mord mtight"},"12")])])])])])])])])])])])])],-1),u=l('<h2 id="库函数配置" tabindex="-1"><a class="header-anchor" href="#库函数配置" aria-hidden="true">#</a> 库函数配置</h2><h3 id="adc-初始化结构体" tabindex="-1"><a class="header-anchor" href="#adc-初始化结构体" aria-hidden="true">#</a> ADC 初始化结构体</h3><ol><li>ADC_Mode 配置 ADC 模式, 仅使用一个 ADC 时为单通道模式, 或可使用双通道及其他细分模式</li><li>ADC_ScanConvMode 是否扫描, ENABLE/DISABLE 设置, 有多个通道时启用</li><li>ADC_ContinuousConvMode 是否连续采样, ENABLE/DISABLE 设置, 关闭时要手动控制才能多次采样</li><li>ADC_ExternalTrigConv 外部触发选择, 通常为软件自动触发</li><li>ADC_DataAlign 对齐模式, Right/Left, 通常为右对齐模式</li><li>ADC_NbrOfChannel 转换通道数, 根据实际设置</li></ol><h3 id="adc-库函数" tabindex="-1"><a class="header-anchor" href="#adc-库函数" aria-hidden="true">#</a> ADC 库函数</h3><h4 id="校准寄存器" tabindex="-1"><a class="header-anchor" href="#校准寄存器" aria-hidden="true">#</a> 校准寄存器</h4><p>使用 ADC 前必须先进行校准</p><ol><li>准备校准寄存器 ADC_ResetCalibration(SC_ADC);</li><li>等待校准寄存器准备就绪 while(ADC_GetResetCalibrationStatus(SC_ADC));</li><li>开始校准 ADC_StartCalibration(SC_ADC);</li><li>等待校准完成 while(ADC_GetCalibrationStatus(SC_ADC));</li></ol><h4 id="设置通道" tabindex="-1"><a class="header-anchor" href="#设置通道" aria-hidden="true">#</a> 设置通道</h4><p>配置通道 设置采样周期为 ADC_RegularChannelConfig(ADCx, 采样通道, 通道次序(从1开始), 采样周期);</p><h4 id="采样结束事件" tabindex="-1"><a class="header-anchor" href="#采样结束事件" aria-hidden="true">#</a> 采样结束事件</h4><ol><li>ADC_IT_EOC 规则通道采样结束中断</li><li>ADC_IT_JEOC 注入通道采样结束中断</li></ol>',11),x=[m,r,h,c,p,o,d,g,u];function y(_,v){return n(),e("div",null,x)}const A=t(i,[["render",y],["__file","ADC.html.vue"]]);export{A as default};
