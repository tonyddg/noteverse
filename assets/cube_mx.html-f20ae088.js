import{_ as a}from"./plugin-vue_export-helper-c27b6911.js";import{r as i,o as l,c,b as e,d as s,a as r,e as t}from"./app-8c5ce49e.js";const d={},o=e("h1",{id:"cube-mx-与项目配置",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#cube-mx-与项目配置","aria-hidden":"true"},"#"),s(" Cube MX 与项目配置")],-1),p={href:"https://blog.csdn.net/qq_35787848/article/details/124512640",target:"_blank",rel:"noopener noreferrer"},u=t(`<h2 id="创建-eide-项目" tabindex="-1"><a class="header-anchor" href="#创建-eide-项目" aria-hidden="true">#</a> 创建 EIDE 项目</h2><h3 id="创建-cubemx-项目" tabindex="-1"><a class="header-anchor" href="#创建-cubemx-项目" aria-hidden="true">#</a> 创建 CubeMX 项目</h3><ol><li>选择 MCU 型号</li><li>SYS -&gt; 设置 Debug 方式</li><li>RCC -&gt; 设置外部时钟(晶振)</li><li>选择使用的外设 (仅 GPIO 可直接点击引脚设置)</li><li>时钟配置 设置 HCLK 为最大(72MHz), 回车</li></ol><h3 id="cubemx-项目设置" tabindex="-1"><a class="header-anchor" href="#cubemx-项目设置" aria-hidden="true">#</a> CubeMX 项目设置</h3><ol><li>Toolchain 设置为 Makefile</li><li>Application Structure 设置为 Advanced</li><li>Code Generator 中设置 仅复制必要库文件</li><li>Code Generator 中设置 为每个外设生成一个 .c/.h 文件</li></ol><h3 id="配置-eide-项目" tabindex="-1"><a class="header-anchor" href="#配置-eide-项目" aria-hidden="true">#</a> 配置 EIDE 项目</h3><ol><li>创建空 Cortex EIDE 项目</li><li>将 CubeMX 项目复制到 EIDE 项目文件夹下</li><li>构建器选择 GCC</li><li>连接器脚本在根目录下 xxx.ld</li><li>向项目资源添加虚拟文件夹 STARTUP</li><li>向 STARTUP 文件夹添加根目录下的 startupxxx.s</li></ol><h3 id="eide-项目属性" tabindex="-1"><a class="header-anchor" href="#eide-项目属性" aria-hidden="true">#</a> EIDE 项目属性</h3><ol><li>包含目录 (可参考生成的 keil 项目中的 Inlude) <ul><li>Inc</li><li>Drivers/CMSIS/Include</li><li>Drivers/STM32F1xx_HAL_Driver/Inc</li><li>Drivers/STM32F1xx_HAL_Driver/Inc/Legacy</li><li>Drivers/CMSIS/Device/ST/STM32F1xx/Include</li></ul></li><li>预定义宏 (可参考生成的 keil 项目中的 预定义宏 LL 库有区别) <ul><li>STM32F103xE (与 startup 文件有关)</li><li>USE_HAL_DRIVER</li></ul></li></ol><h2 id="编辑项目" tabindex="-1"><a class="header-anchor" href="#编辑项目" aria-hidden="true">#</a> 编辑项目</h2><ol><li>打开 xxx.ioc 可再次求改项目</li><li>修改完成后需要重新生成</li><li>根据 main.c 的提示修改代码, 防止被覆盖</li></ol><h2 id="c-c-混合编程" tabindex="-1"><a class="header-anchor" href="#c-c-混合编程" aria-hidden="true">#</a> C/C++ 混合编程</h2><ol start="0"><li>构建器选项 -&gt; 连接器选项 -&gt; 添加 -lstdc++ 保证虚函数的使用</li><li>保留 CubeMX 生成的 .c 代码</li><li>通过 .c 代码运行 .h 中的通过 .cpp 定义的函数实现混合编程</li><li>通过以下方式, 将函数与全局变量暴露给 .c</li></ol><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token comment">// .c 定义的头文件</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;stm32f1xx_hal.h&quot;</span></span>

<span class="token comment">// 函数</span>
<span class="token keyword">void</span> <span class="token function">cppDefFun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 全局变量</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> c<span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>使用宏规定哪些部分暴露给 .c 文件的部分使用</li></ol><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token comment">// 不暴露部分 如 class 定义等</span>
<span class="token macro property"><span class="token directive-hash">#</span> <span class="token directive keyword">endif</span></span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span><span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token comment">// 暴露部分</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="踩坑笔记" tabindex="-1"><a class="header-anchor" href="#踩坑笔记" aria-hidden="true">#</a> 踩坑笔记</h2><h3 id="eide" tabindex="-1"><a class="header-anchor" href="#eide" aria-hidden="true">#</a> EIDE</h3><ol><li>烧录配置中 接口属性使用 cmsis-dap.cfg</li><li>debug 出错时, 检查是否勾选选项中的 将 axf 转为 elf</li><li>debug 前先烧录程序</li><li>使用 ADC连续转换+DMA 可能会导致无法烧录的 bug, 需要在烧录前关闭此功能或关闭ADC连续转换功能</li></ol>`,19);function h(v,k){const n=i("ExternalLinkIcon");return l(),c("div",null,[o,e("p",null,[e("a",p,[s("待学习的资料"),r(n)])]),u])}const x=a(d,[["render",h],["__file","cube_mx.html.vue"]]);export{x as default};
